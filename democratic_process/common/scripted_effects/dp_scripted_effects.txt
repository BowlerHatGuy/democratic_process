##########################################
# Scripted Effects for Democratic Process
##########################################

# Leader Scope
dp_assign_candidate_number = {
	if = {
		limit = {
			owner = {
				NOT = {
					any_owned_leader = { has_leader_flag = dp_pres_candidate_01 }
				}
			}
		}
		set_leader_flag = dp_pres_candidate_01
		save_event_target_as = dp_pres_candidate_01
	}
	else_if = {
		limit = {
			owner = {
				NOT = {
					any_owned_leader = { has_leader_flag = dp_pres_candidate_02 }
				}
			}
		}
		set_leader_flag = dp_pres_candidate_02
		save_event_target_as = dp_pres_candidate_02
	}
	else_if = {
		limit = {
			owner = {
				NOT = {
					any_owned_leader = { has_leader_flag = dp_pres_candidate_03 }
				}
			}
		}
		set_leader_flag = dp_pres_candidate_03
		save_event_target_as = dp_pres_candidate_03
	}
	else = {
		set_leader_flag = dp_pres_candidate_04
		save_event_target_as = dp_pres_candidate_04
	}
}

dp_set_leader_ethic_flag = {
	if = {
		limit = { leader_of_faction = totalitarian }
		set_leader_flag = dp_authoritarian_leaning
	}
	if = {
		limit = { leader_of_faction = imperialist }
		set_leader_flag = dp_militarist_leaning
	}
	if = {
		limit = { 
			OR = {
				leader_of_faction = supremacist
				leader_of_faction = isolationist
			}
		}
		set_leader_flag = dp_xenophobe_leaning
	}
	if = {
		limit = { leader_of_faction = progressive }
		set_leader_flag = dp_egalitarian_leaning
	}
	if = {
		limit = { leader_of_faction = technologist }
		set_leader_flag = dp_materialist_leaning
	}
	if = {
		limit = { leader_of_faction = xenoist }
		set_leader_flag = dp_xenophile_leaning
	}
	if = {
		limit = { leader_of_faction = traditionalist }
		set_leader_flag = dp_spiritualist_leaning
	}
	if = {
		limit = { leader_of_faction = prosperity }
		set_leader_flag = dp_pacifist_leaning
	}
	
	if = { # Adds a leaning based on traits if they do not already have one
		limit = {
			NOR = {
				has_leader_flag = dp_authoritarian_leaning
				has_leader_flag = dp_egalitarian_leaning
				has_leader_flag = dp_militarist_leaning
				has_leader_flag = dp_pacifist_leaning
				has_leader_flag = dp_spiritualist_leaning
				has_leader_flag = dp_materialist_leaning
				has_leader_flag = dp_xenophile_leaning
				has_leader_flag = dp_xenophobe_leaning
			}
		}
		random_list = {
			0 = { # Authoritarian
				modifier = {
					OR = {
						owner = { has_ethic = ethic_authoritarian }
						owner = { has_ethic = ethic_fanatic_authoritarian }
						has_trait = leader_trait_unyielding
						has_trait = leader_trait_glory_seeker
						has_trait = leader_trait_iron_fist
						has_trait = leader_trait_retired_fleet_officer
						has_trait = leader_trait_paranoid
					}
					add = 20
				}
				set_leader_flag = dp_authoritarian_leaning
			}
			0 = { # Egalitarian
				modifier = {
					OR = {
						owner = { has_ethic = ethic_egalitarian }
						owner = { has_ethic = ethic_fanatic_egalitarian }
						has_trait = leader_trait_army_veteran
						has_trait = leader_trait_towel
					}
					add = 20
				}
				set_leader_flag = dp_egalitarian_leaning
			}
			0 = { # Militarist
				modifier = {
					OR = {
						owner = { has_ethic = ethic_militarist }
						owner = { has_ethic = ethic_fanatic_militarist }
						leader_class = admiral
						leader_class = general
						has_trait = leader_trait_army_veteran
						has_trait = leader_trait_retired_fleet_officer
						has_trait = leader_trait_expertise_military_theory
					}
					add = 20
				}
				set_leader_flag = dp_militarist_leaning
			}
			0 = { # Pacifist
				modifier = {
					OR = {
						owner = { has_ethic = ethic_pacifist }
						owner = { has_ethic = ethic_fanatic_pacifist }
						has_trait = leader_trait_cautious
						has_trait = leader_trait_army_veteran
						has_trait = leader_trait_retired_fleet_officer
						has_trait = leader_trait_agrarian_upbringing
						has_trait = leader_trait_expertise_particles
						has_trait = leader_trait_towel
					}
					add = 20
				}
				set_leader_flag = dp_pacifist_leaning
			}
			0 = { # Spiritualist
				modifier = {
					OR = {
						owner = { has_ethic = ethic_spiritualist }
						owner = { has_ethic = ethic_fanatic_spiritualist }
						has_trait = leader_trait_nervous
						has_trait = leader_trait_admiral_chosen
						has_trait = leader_trait_admiral_psionic
						has_trait = leader_trait_glory_seeker
						has_trait = leader_trait_general_psionic
						has_trait = leader_trait_general_chosen
						has_trait = leader_trait_agrarian_upbringing
						has_trait = leader_trait_intellectual
						has_trait = leader_trait_governor_psionic
						has_trait = leader_trait_governor_chosen
						has_trait = leader_trait_scientist_psionic
						has_trait = leader_trait_scientist_chosen
					}
					add = 20
				}
				set_leader_flag = dp_spiritualist_leaning
			}
			0 = { # Materialist
				modifier = {
					OR = {
						owner = { has_ethic = ethic_materialist }
						owner = { has_ethic = ethic_fanatic_materialist }
						has_trait = leader_trait_fleet_logistician
						has_trait = leader_trait_lethargic
						has_trait = leader_trait_admiral_synthetic
						has_trait = leader_trait_glory_seeker
						has_trait = leader_trait_general_cyborg
						has_trait = leader_trait_general_synthetic
						has_trait = leader_trait_intellectual
						has_trait = leader_trait_governor_cyborg
						has_trait = leader_trait_governor_synthetic
						has_trait = leader_trait_maniacal
						has_trait = leader_trait_expertise_industry
						has_trait = leader_trait_scientist_cyborg
						has_trait = leader_trait_scientist_synthetic
					}
					add = 20
				}
				set_leader_flag = dp_materialist_leaning
			}
			0 = { # Xenophile
				modifier = {
					OR = {
						owner = { has_ethic = ethic_xenophile }
						owner = { has_ethic = ethic_fanatic_xenophile }
						has_trait = leader_trait_agrarian_upbringing
						has_trait = leader_trait_archaeologist
						has_trait = leader_trait_towel
					}
					add = 20
				}
				set_leader_flag = dp_xenophile_leaning
			}
			0 = { # Xenophobe
				modifier = {
					OR = {
						owner = { has_ethic = ethic_xenophobe }
						owner = { has_ethic = ethic_fanatic_xenophobe }
						has_trait = leader_trait_agrarian_upbringing
						has_trait = leader_trait_paranoid
					}
					add = 20
				}
				set_leader_flag = dp_xenophobe_leaning
			}
		}
	}
}

dp_set_leader_ethic_flag_pop = {
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
			}
		}
		set_leader_flag = dp_authoritarian_leaning
	}
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
			}
		}
		set_leader_flag = dp_egalitarian_leaning
	}
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
			}
		}
		set_leader_flag = dp_spiritualist_leaning
	}
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
			}
		}
		set_leader_flag = dp_materialist_leaning
	}
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
			}
		}
		set_leader_flag = dp_militarist_leaning
	}
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
			}
		}
		set_leader_flag = dp_pacifist_leaning
	}
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
			}
		}
		set_leader_flag = dp_xenophile_leaning
	}
	if = {
		limit = {
			event_target:dp_random_pop = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
			}
		}
		set_leader_flag = dp_authoritarian_leaning
	}
}

dp_set_leader_ethic_trait = {
	if = {
		limit = { has_leader_flag = dp_authoritarian_leaning }
		add_trait = trait_dp_ruler_authoritarian
	}
	else = {
		remove_trait = trait_dp_ruler_authoritarian
	}
	
	if = {
		limit = { has_leader_flag = dp_egalitarian_leaning }
		add_trait = trait_dp_ruler_egalitarian
	}
	else = {
		remove_trait = trait_dp_ruler_egalitarian
	}
	
	if = {
		limit = { has_leader_flag = dp_spiritualist_leaning }
		add_trait = trait_dp_ruler_spiritualist
	}
	else = {
		remove_trait = trait_dp_ruler_spiritualist
	}
	
	if = {
		limit = { has_leader_flag = dp_materialist_leaning }
		add_trait = trait_dp_ruler_materialist
	}
	else = {
		remove_trait = trait_dp_ruler_materialist
	}
	
	if = {
		limit = { has_leader_flag = dp_militarist_leaning }
		add_trait = trait_dp_ruler_militarist
	}
	else = {
		remove_trait = trait_dp_ruler_militarist
	}
	
	if = {
		limit = { has_leader_flag = dp_pacifist_leaning }
		add_trait = trait_dp_ruler_pacifist
	}
	else = {
		remove_trait = trait_dp_ruler_pacifist
	}
	
	if = {
		limit = { has_leader_flag = dp_xenophile_leaning }
		add_trait = trait_dp_ruler_xenophile
	}
	else = {
		remove_trait = trait_dp_ruler_xenophile
	}
	
	if = {
		limit = { has_leader_flag = dp_xenophobe_leaning }
		add_trait = trait_dp_ruler_xenophobe
	}
	else = {
		remove_trait = trait_dp_ruler_xenophobe
	}
}